{"version":3,"sources":["webpack:///bundle.js","webpack:///webpack/bootstrap fc78654e8165749334c7","webpack:///./src/lib/Util.ts","webpack:///./src/lib/states/State.ts","webpack:///./src/lib/states/MenuState.ts","webpack:///./src/lib/states/StateMachine.ts","webpack:///./src/main.ts","webpack:///./src/lib/geom/Point.ts","webpack:///./src/lib/states/GameState.ts","webpack:///./src/lib/assets/AssetLibrary.ts","webpack:///./src/lib/assets/Asset.ts"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","i","l","call","m","c","value","d","name","getter","Object","defineProperty","configurable","enumerable","get","n","__esModule","o","object","property","prototype","hasOwnProperty","p","s","Util","async","list","process","callback","next","length","State","__extends","this","b","__","constructor","create","main_1","GameState_1","State_1","Point_1","Util_1","MenuState","_super","_this","ready","currentTask","currentProgress","click","event","Point","offsetX","offsetY","game","stateMachine","push","GameState","render","context","clearRect","width","height","message","font","fillStyle","measureText","fillText","requestAnimationFrame","update","self","loadAssets","task","status","progress","callback_","Math","round","StateMachine","stack","empty","peek","Error","state","pop","undefined","StateMachine_1","MenuState_1","AssetLibrary_1","Game","processed","total","assetLibrary","assets","asset","callback__","load","resize","canvas","window","innerWidth","innerHeight","current","e","console","log","init","document","getElementById","getContext","onresize","onclick","AssetLibrary","x","y","Asset_1","Asset","type","path","loaded","$","data","fail","error"],"mappings":"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","file":"bundle.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// identity function for calling harmory imports with the correct context\n/******/ \t__webpack_require__.i = function(value) { return value; };\n/******/\n/******/ \t// define getter function for harmory exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tObject.defineProperty(exports, name, {\n/******/ \t\t\tconfigurable: false,\n/******/ \t\t\tenumerable: true,\n/******/ \t\t\tget: getter\n/******/ \t\t});\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 5);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports) {\n\n\"use strict\";\n\"use strict\";\nvar Util = (function () {\n    function Util() {\n    }\n    Util.async = function (list, process, callback) {\n        (function next(i) {\n            if (i < list.length) {\n                process(list[i], function () {\n                    next(i + 1);\n                });\n            }\n            else {\n                callback();\n            }\n        })(0);\n    };\n    return Util;\n}());\nexports.Util = Util;\n\n\n/***/ },\n/* 1 */\n/***/ function(module, exports) {\n\n\"use strict\";\n\"use strict\";\nvar State = (function () {\n    function State() {\n    }\n    return State;\n}());\nexports.State = State;\n\n\n/***/ },\n/* 2 */,\n/* 3 */\n/***/ function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar main_1 = __webpack_require__(5);\nvar GameState_1 = __webpack_require__(7);\nvar State_1 = __webpack_require__(1);\nvar Point_1 = __webpack_require__(6);\nvar Util_1 = __webpack_require__(0);\nvar MenuState = (function (_super) {\n    __extends(MenuState, _super);\n    function MenuState() {\n        var _this = _super.call(this) || this;\n        _this.ready = false;\n        _this.currentTask = \"\";\n        _this.currentProgress = 0;\n        _this.click = function (event) {\n            var mouse = new Point_1.Point(event.offsetX, event.offsetY);\n            if (_this.ready) {\n                main_1.game.stateMachine.push(new GameState_1.GameState());\n            }\n        };\n        _this.render = function () {\n            main_1.game.context.clearRect(0, 0, main_1.game.width, main_1.game.height);\n            var message = \"\";\n            if (!_this.ready) {\n                message = \"Loading \" + _this.currentTask + \": \" + _this.currentProgress + \"%\";\n            }\n            else {\n                message = \"Click anywhere to start.\";\n            }\n            main_1.game.context.font = \"20px 'Open Sans'\";\n            main_1.game.context.fillStyle = \"#fff\";\n            var width = main_1.game.context.measureText(message).width;\n            main_1.game.context.fillText(message, (main_1.game.width - width) / 2, main_1.game.height / 2);\n            requestAnimationFrame(_this.render);\n        };\n        _this.update = function () { };\n        var self = _this;\n        requestAnimationFrame(_this.render);\n        Util_1.Util.async([main_1.game.loadAssets], function (task, callback) {\n            task(function (task, status, progress, callback_) {\n                self.currentTask = task;\n                if (status === \"done\") {\n                    callback();\n                }\n                else if (status === \"progress\" && progress !== null) {\n                    self.currentProgress = Math.round(progress * 10000) / 100.0;\n                    callback_();\n                }\n            });\n        }, function () {\n            // self.ready = true;\n        });\n        return _this;\n    }\n    return MenuState;\n}(State_1.State));\nexports.MenuState = MenuState;\n\n\n/***/ },\n/* 4 */\n/***/ function(module, exports) {\n\n\"use strict\";\n\"use strict\";\nvar StateMachine = (function () {\n    function StateMachine() {\n        this.stack = [];\n    }\n    StateMachine.prototype.empty = function () {\n        return this.stack.length === 0;\n    };\n    StateMachine.prototype.peek = function () {\n        if (this.empty()) {\n            throw new Error(\"State machine is empty.\");\n        }\n        return this.stack[this.stack.length - 1];\n    };\n    StateMachine.prototype.push = function (state) {\n        this.stack.push(state);\n    };\n    StateMachine.prototype.pop = function () {\n        var state = this.stack.pop();\n        if (state === undefined) {\n            throw new Error(\"State machine is empty.\");\n        }\n        return state;\n    };\n    return StateMachine;\n}());\nexports.StateMachine = StateMachine;\n\n\n/***/ },\n/* 5 */\n/***/ function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\"use strict\";\nvar StateMachine_1 = __webpack_require__(4);\nvar MenuState_1 = __webpack_require__(3);\nvar AssetLibrary_1 = __webpack_require__(8);\nvar Util_1 = __webpack_require__(0);\nvar Game = (function () {\n    function Game() {\n        var _this = this;\n        this.loadAssets = function (callback) {\n            var processed = 0;\n            var total = _this.assetLibrary.assets.length;\n            Util_1.Util.async(_this.assetLibrary.assets, function (asset, callback__) {\n                asset.load(function () {\n                    processed += 1;\n                    callback(\"assets\", \"progress\", processed * 1.0 / total, function () {\n                        callback__();\n                    });\n                });\n            }, function () {\n                callback(\"assets\", \"done\", null, function () { });\n            });\n        };\n        this.resize = function (event) {\n            _this.canvas.width = _this.width = window.innerWidth;\n            _this.canvas.height = _this.height = window.innerHeight;\n        };\n        this.click = function (event) {\n            try {\n                var current = _this.stateMachine.peek();\n                current.click(event);\n            }\n            catch (e) {\n                console.log(\"Error reading from stateMachine: \" + e);\n            }\n        };\n        this.init = function () {\n            _this.canvas = document.getElementById(\"canvas\");\n            var context = _this.canvas.getContext(\"2d\");\n            if (context === null)\n                return;\n            _this.context = context;\n            window.onresize = _this.resize;\n            window.onclick = _this.click;\n            _this.resize();\n            _this.assetLibrary = new AssetLibrary_1.AssetLibrary();\n            _this.stateMachine = new StateMachine_1.StateMachine();\n            _this.stateMachine.push(new MenuState_1.MenuState());\n        };\n        console.log(\"Mergem\");\n    }\n    return Game;\n}());\nexports.Game = Game;\nexports.game = new Game();\nexports.game.init();\n\n\n/***/ },\n/* 6 */\n/***/ function(module, exports) {\n\n\"use strict\";\n\"use strict\";\nvar Point = (function () {\n    function Point(x, y) {\n        this.x = x;\n        this.y = y;\n    }\n    return Point;\n}());\nexports.Point = Point;\n\n\n/***/ },\n/* 7 */\n/***/ function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar State_1 = __webpack_require__(1);\nvar GameState = (function (_super) {\n    __extends(GameState, _super);\n    function GameState() {\n        var _this = _super.call(this) || this;\n        _this.click = function (event) {\n        };\n        _this.render = function () { };\n        _this.update = function () { };\n        console.log(\"SHIET\");\n        return _this;\n    }\n    return GameState;\n}(State_1.State));\nexports.GameState = GameState;\n\n\n/***/ },\n/* 8 */\n/***/ function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\"use strict\";\nvar Asset_1 = __webpack_require__(9);\nvar AssetLibrary = (function () {\n    function AssetLibrary() {\n        this.assets = [];\n        this.assets.push(new Asset_1.Asset(\"sound\", \"applause\", \"applause.mp3\"));\n        this.assets.push(new Asset_1.Asset(\"music\", \"bgm\", \"bgm.mp3\"));\n        this.assets.push(new Asset_1.Asset(\"sound\", \"end\", \"end.mp3\"));\n        this.assets.push(new Asset_1.Asset(\"music\", \"endgame\", \"endgame.mp3\"));\n        this.assets.push(new Asset_1.Asset(\"image\", \"floor\", \"floor.png\"));\n        this.assets.push(new Asset_1.Asset(\"sound\", \"ice\", \"ice.mp3\"));\n        this.assets.push(new Asset_1.Asset(\"image\", \"ice\", \"ice.png\"));\n        this.assets.push(new Asset_1.Asset(\"sound\", \"menuhit\", \"menuhit.wav\"));\n        this.assets.push(new Asset_1.Asset(\"sound\", \"merge\", \"merge.mp3\"));\n        this.assets.push(new Asset_1.Asset(\"sound\", \"portal\", \"portal.mp3\"));\n        this.assets.push(new Asset_1.Asset(\"image\", \"portal\", \"portal.png\"));\n        this.assets.push(new Asset_1.Asset(\"sound\", \"retry\", \"retry.mp3\"));\n        this.assets.push(new Asset_1.Asset(\"image\", \"space\", \"space.png\"));\n        this.assets.push(new Asset_1.Asset(\"image\", \"sprite\", \"sprite.png\"));\n        this.assets.push(new Asset_1.Asset(\"image\", \"sprite1\", \"sprite1.png\"));\n        this.assets.push(new Asset_1.Asset(\"sound\", \"step\", \"step.mp3\"));\n        this.assets.push(new Asset_1.Asset(\"image\", \"switch\", \"switch.png\"));\n        this.assets.push(new Asset_1.Asset(\"sound\", \"switch\", \"switch.wav\"));\n        this.assets.push(new Asset_1.Asset(\"image\", \"wall\", \"wall.png\"));\n    }\n    return AssetLibrary;\n}());\nexports.AssetLibrary = AssetLibrary;\n\n\n/***/ },\n/* 9 */\n/***/ function(module, exports) {\n\n\"use strict\";\n/// <reference path=\"../../../typings/globals/jquery/index.d.ts\" />\n\"use strict\";\nvar Asset = (function () {\n    function Asset(type, name, path) {\n        var _this = this;\n        this.type = type;\n        this.name = name;\n        this.path = path;\n        this.loaded = false;\n        this.load = function (callback) {\n            $.get(\"assets/\" + _this.path, function (data) {\n                _this.data = data;\n                _this.loaded = true;\n                callback();\n            }).fail(function () {\n                console.error(\"Failed to load asset \" + _this.path + \".\");\n            });\n        };\n    }\n    return Asset;\n}());\nexports.Asset = Asset;\n\n\n/***/ }\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// bundle.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmory imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmory exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tObject.defineProperty(exports, name, {\n \t\t\tconfigurable: false,\n \t\t\tenumerable: true,\n \t\t\tget: getter\n \t\t});\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 5);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap fc78654e8165749334c7","export class Util {\n    static async(list: any[], process: (item: any, callback: () => void) => void, callback: () => void) {\n        (function next(i: number) {\n            if (i < list.length) {\n                process(list[i], function () {\n                    next(i + 1);\n                });\n            } else {\n                callback();\n            }\n        })(0);\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/Util.ts","export abstract class State {\n    abstract click: (event: MouseEvent) => void;\n    abstract render: () => void;\n    abstract update: () => void;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/states/State.ts","import { game } from \"../../main\";\nimport { GameState } from \"./GameState\";\nimport { State } from \"./State\";\nimport { Point } from \"../geom/Point\";\nimport { Util } from \"../Util\";\n\nexport class MenuState extends State {\n    ready: boolean = false;\n    currentTask: string = \"\";\n    currentProgress: number = 0;\n\n    constructor() {\n        super();\n\n        const self = this;\n        requestAnimationFrame(this.render);\n        Util.async([game.loadAssets], function (task, callback) {\n            task(function (task: string, status: string, progress: number | null, callback_: () => void) {\n                self.currentTask = task;\n                if (status === \"done\") {\n                    callback();\n                } else if (status === \"progress\" && progress !== null) {\n                    self.currentProgress = Math.round(progress * 10000) / 100.0;\n                    callback_();\n                }\n            });\n        }, function () {\n            // self.ready = true;\n        });\n    }\n    click = (event: MouseEvent) => {\n        const mouse: Point = new Point(event.offsetX, event.offsetY);\n        if (this.ready) {\n            game.stateMachine.push(new GameState());\n        }\n    }\n    render = () => {\n        game.context.clearRect(0, 0, game.width, game.height);\n        const message = \"\";\n        if (!this.ready) {\n            message = `Loading ${this.currentTask}: ${this.currentProgress}%`;\n        } else {\n            message = \"Click anywhere to start.\";\n        }\n\n        game.context.font = \"20px 'Open Sans'\";\n        game.context.fillStyle = \"#fff\";\n        const width: number = game.context.measureText(message).width;\n\n        game.context.fillText(message, (game.width - width) / 2, game.height / 2);\n        requestAnimationFrame(this.render);\n    }\n    update = () => { };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/states/MenuState.ts","import { State } from \"./State\";\n\nexport class StateMachine {\n    private stack: State[];\n    constructor() {\n        this.stack = [];\n    }\n    empty(): boolean {\n        return this.stack.length === 0;\n    }\n    peek(): State {\n        if (this.empty()) {\n            throw new Error(\"State machine is empty.\");\n        }\n        return this.stack[this.stack.length - 1];\n    }\n    push(state: State): void {\n        this.stack.push(state);\n    }\n    pop(): State {\n        const state = this.stack.pop();\n        if (state === undefined) {\n            throw new Error(\"State machine is empty.\");\n        }\n        return state;\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/states/StateMachine.ts","import { StateMachine } from \"./lib/states/StateMachine\";\nimport { MenuState } from \"./lib/states/MenuState\";\nimport { State } from \"./lib/states/State\";\nimport { LevelLoader } from \"./lib/levels/LevelLoader\";\nimport { Asset } from \"./lib/assets/Asset\";\nimport { AssetLibrary } from \"./lib/assets/AssetLibrary\";\nimport { Util } from \"./lib/Util\";\n\n\nexport class Game {\n    levelLibrary: LevelLoader;\n    assetLibrary: AssetLibrary;\n    stateMachine: StateMachine;\n    canvas: HTMLCanvasElement;\n    context: CanvasRenderingContext2D;\n    width: number;\n    height: number;\n\n    constructor() {\n        console.log(\"Mergem\");\n    }\n    loadAssets = (callback: (task: string, status: string, progress: number | null, callback_: () => void) => void) => {\n        let processed: number = 0;\n        const total: number = this.assetLibrary.assets.length;\n        Util.async(this.assetLibrary.assets, function (asset: Asset, callback__) {\n            asset.load(() => {\n                processed += 1;\n                callback(\"assets\", \"progress\", processed * 1.0 / total, () => {\n                    callback__();\n                });\n            });\n        }, function () {\n            callback(\"assets\", \"done\", null, () => { });\n        });\n    }\n    resize = (event?: Event) => {\n        this.canvas.width = this.width = window.innerWidth;\n        this.canvas.height = this.height = window.innerHeight;\n    }\n    click = (event: MouseEvent) => {\n        try {\n            const current = this.stateMachine.peek();\n            current.click(event);\n        } catch (e) {\n            console.log(`Error reading from stateMachine: ${e}`);\n        }\n    }\n    init = () => {\n        this.canvas = <HTMLCanvasElement>document.getElementById(\"canvas\");\n        const context = this.canvas.getContext(\"2d\");\n        if (context === null) return;\n        this.context = context;\n\n        window.onresize = this.resize;\n        window.onclick = this.click;\n        this.resize();\n\n        this.assetLibrary = new AssetLibrary();\n        this.stateMachine = new StateMachine();\n        this.stateMachine.push(new MenuState());\n    }\n}\n\nexport const game = new Game();\ngame.init();\n\n\n// WEBPACK FOOTER //\n// ./src/main.ts","export class Point {\n    constructor(public x: number, public y: number) {\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/geom/Point.ts","import { State } from \"./State\";\n\nexport class GameState extends State {\n    constructor() {\n        super();\n        console.log(\"SHIET\");\n    }\n    click = (event: MouseEvent) => {\n    }\n    render = () => { };\n    update = () => { };\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/states/GameState.ts","import { Asset } from \"./Asset\";\n\nexport class AssetLibrary {\n    assets: Asset[];\n    constructor() {\n        this.assets = [];\n\n        this.assets.push(new Asset(\"sound\", \"applause\", \"applause.mp3\"));\n        this.assets.push(new Asset(\"music\", \"bgm\", \"bgm.mp3\"));\n        this.assets.push(new Asset(\"sound\", \"end\", \"end.mp3\"));\n        this.assets.push(new Asset(\"music\", \"endgame\", \"endgame.mp3\"));\n        this.assets.push(new Asset(\"image\", \"floor\", \"floor.png\"));\n        this.assets.push(new Asset(\"sound\", \"ice\", \"ice.mp3\"));\n        this.assets.push(new Asset(\"image\", \"ice\", \"ice.png\"));\n        this.assets.push(new Asset(\"sound\", \"menuhit\", \"menuhit.wav\"));\n        this.assets.push(new Asset(\"sound\", \"merge\", \"merge.mp3\"));\n        this.assets.push(new Asset(\"sound\", \"portal\", \"portal.mp3\"));\n        this.assets.push(new Asset(\"image\", \"portal\", \"portal.png\"));\n        this.assets.push(new Asset(\"sound\", \"retry\", \"retry.mp3\"));\n        this.assets.push(new Asset(\"image\", \"space\", \"space.png\"));\n        this.assets.push(new Asset(\"image\", \"sprite\", \"sprite.png\"));\n        this.assets.push(new Asset(\"image\", \"sprite1\", \"sprite1.png\"));\n        this.assets.push(new Asset(\"sound\", \"step\", \"step.mp3\"));\n        this.assets.push(new Asset(\"image\", \"switch\", \"switch.png\"));\n        this.assets.push(new Asset(\"sound\", \"switch\", \"switch.wav\"));\n        this.assets.push(new Asset(\"image\", \"wall\", \"wall.png\"));\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/assets/AssetLibrary.ts","/// <reference path=\"../../../typings/globals/jquery/index.d.ts\" />\n\nexport class Asset {\n    loaded: boolean = false;\n    data: any;\n    constructor(public type: string, public name: string, public path: string) {\n    }\n    load = (callback: () => void) => {\n        $.get(`assets/${this.path}`, (data: any) => {\n            this.data = data;\n            this.loaded = true;\n            callback();\n        }).fail(() => {\n            console.error(`Failed to load asset ${this.path}.`);\n        });\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/assets/Asset.ts"],"sourceRoot":""}